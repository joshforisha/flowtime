<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"content="object-src 'none'; script-src 'unsafe-inline' 'self'"><meta name="description"content="A very simple interface for managing Flowtime tasks"><meta name="msapplication-TileColor"content="#DA532C"><meta name="theme-color"content="#5E81AC"><meta name="viewport"content="initial-scale=1,width=device-width"><title>Flowtime</title><link rel="apple-touch-icon"href="./apple-touch-icon.png"><link rel="icon"href="./icon-16.png"sizes="16x16"><link rel="icon"href="./icon-32.png"sizes="32x32"><link rel="manifest"href="./manifest.json"><link rel="mask-icon"href="./safari-pinned-tab.svg"color="#4C566A"><style>:root{font-size:clamp(14px,2vw,20px);line-height:1.5;--nord0:#2e3440;--nord1:#3b4252;--nord2:#434c5e;--nord3:#4c566a;--nord4:#d8dee9;--nord5:#e5e9f0;--nord6:#eceff4;--nord7:#8fbcbb;--nord8:#88c0d0;--nord9:#81a1c1;--nordA:#5e81ac;--nordB:#bf616a;--nordC:#d08770;--nordD:#ebcb8b;--nordE:#a3be8c;--nordF:#b48ead;--sans-serif-fonts:-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,helvetica,Ubuntu,roboto,noto,arial,sans-serif}*{box-sizing:border-box}@keyframes blink{0%{opacity:.9}70%{opacity:.9}80%{opacity:1}100%{opacity:.9}}body{background-color:var(--nord0);color:var(--nord4);font-family:var(--sans-serif-fonts);font-weight:400;margin:0}button{align-items:center;background-color:var(--nord4);border-radius:24px;border-width:0;color:var(--nord2);cursor:pointer;display:inline-flex;flex-shrink:0;font-family:inherit;font-size:1em;font-weight:500;justify-content:center;line-height:1;min-height:48px;min-width:48px;transition:all .1s ease-out;transition-property:background-color,color,opacity}button:disabled{opacity:0;pointer-events:none}button[data-action=clear]{background-color:var(--nordC)}button[data-action=complete]{animation:1s blink infinite;background-color:var(--nordD);font-size:.8em;position:relative}button[data-action=complete]:disabled{animation:none;background-color:var(--nord4);opacity:.33}button[data-action=complete] span{pointer-events:none}button[data-action=complete] em{align-items:center;background-color:var(--nordE);border-radius:24px;display:flex;font-size:1rem;height:100%;justify-content:center;left:0;opacity:0;pointer-events:none;position:absolute;top:0;transition:opacity .1s ease-out;width:100%}button[data-action=create]{background-color:var(--nord9)}button[data-action=delete]{background-color:var(--nordB);color:var(--nord4)}button[data-action=move]{background-color:var(--nord6);border-radius:2px 12px 12px 2px;cursor:grab;margin-right:.5rem;min-width:unset;width:1rem}button[data-action=start]{background-color:var(--nordD)}footer{background-color:var(--nord1);bottom:0;display:flex;justify-content:center;left:0;padding:1rem;position:fixed;width:100%}footer button{margin:0 1rem;padding:0 1rem 0 .75rem}input[type=text]{background-color:transparent;border:none;border-radius:2px;color:inherit;font:inherit;font-size:1.25em;outline:1px solid var(--nord9);padding:0 5px;transition:outline .1s ease-out;width:100%}input[type=text]:focus{outline-color:var(--nord8)}li{align-items:center;background-color:var(--nord1);border-radius:2px;display:flex;margin-bottom:.5rem;padding:.5rem .5rem .5rem 0;white-space:nowrap}li button[data-action=complete]{display:none}li input{margin:0 .5rem}li.-active input{color:var(--nordD)}li.-active button[data-action=complete],li.-done button[data-action=complete]{display:block}li.-active button[data-action=start],li.-done button[data-action=start]{display:none}li.-done{color:var(--nord3)}progress{appearance:none;border:none;height:.5rem;left:0;opacity:0;pointer-events:none;position:fixed;top:0;transition:opacity .1s ease-out;width:100%}progress[value]{opacity:1}progress::-webkit-progress-bar{background-color:var(--nord2)}progress::-webkit-progress-value{background-color:var(--nord4)}ul{list-style-type:none;margin:2rem .5rem 5rem;padding:0}@media screen and (hover:hover){button{opacity:.9;transition:opacity .1s ease-out}button[data-action=delete],button[data-action=move],button[data-action=start]{opacity:0}button[data-action=complete]:hover{animation:none;opacity:1}button:not(:disabled):hover{opacity:1!important}input[type=text]{outline-color:transparent}li{background-color:transparent}li:hover{background-color:var(--nord1)}li:hover input[type=text]:not(:disabled):not(:focus){outline-color:var(--nord9)}button[data-action=complete]:hover em{opacity:1}li:hover button[data-action=move]{opacity:.3}li:hover button[data-action=delete],li:not(.-active):hover button[data-action=start]:not(:disabled){opacity:.9}}</style><progress></progress><ul></ul><footer><button data-action="create"title="Add task (shortcut: A)">&plus;&ensp;Add</button> <button data-action="clear"title="Clear tasks">&times;&ensp;Clear</button></footer><audio><source src="chime.wav"type="audio/wav"></audio><script>const version="4",$=(window.localStorage.getItem("version")!==version&&(window.localStorage.clear(),window.localStorage.setItem("version",version),window.localStorage.setItem("tasks",JSON.stringify(tasks))),t=>document.querySelector(t)),$$=t=>Array.from(document.querySelectorAll(t)),chime=$("audio"),progressBar=$("progress"),tasksList=$("ul"),minute=6e4;let breaking=!1,draggingItem,tasks=JSON.parse(window.localStorage.getItem("tasks"))||[],timerTimeout,timerInterval;function createTask(){return{completed:null,id:Date.now().toString(),name:"",started:null}}function addTask(){var t=createTask();const e=taskItem(t);tasksList.appendChild(e),e.querySelector("input").focus(),updateTasks(tasks.concat(t))}function breakMinutes(t){return t<=4?1:t<=25?5:t<=50?8:t<=90?10:15}function busyWithTask(){return tasks.some(t=>Number.isInteger(t.started)&&!Number.isInteger(t.completed))}function button(t,e={}){return"string"==typeof e&&(e={textContent:e}),h("button",{...e=Array.isArray(e)?{children:e}:e,attributes:{"data-action":t,...e.attributes}})}function completeTask(e){timerTimeout&&clearTimeout(timerTimeout),timerInterval&&clearInterval(timerInterval);const t=getTask(e);t.completed=Date.now();var a=breakMinutes(elapsedMinutes(t));const r=$(`li[data-id="${e}"]`);r.classList.add("-done"),r.classList.remove("-active"),r.querySelector('button[data-action="complete"]').setAttribute("disabled",""),startBreak(a),updateTasks(tasks.filter(t=>t.id!==e).concat(t)),tasksList.appendChild(r)}function elapsedMinutes(t){return Math.ceil((t.completed-t.started)/6e4)}function findTaskIndex(t){for(var e in tasksList.children)if(tasksList.children.item(e)===t)return e}function getTask(e){return tasks.find(t=>t.id===e)}function h(t,e={}){"string"==typeof e&&(e={textContent:e});const{actions:a,attributes:r,children:s,classes:n=[],textContent:i}=e=Array.isArray(e)?{children:e}:e,[o,...d]=t.split("."),u=document.createElement(o);if(r)for(var[c,l]of Object.entries(r))void 0!==l&&u.setAttribute(c,l);for(const m of d.filter(t=>t))u.classList.add(m);for(const g of n.filter(t=>t))u.classList.add(g);if(i&&(u.textContent=i),s)for(const k of s)k&&u.appendChild(k);if(a)for(const[p,f]of Object.entries(a))u.addEventListener(p,t=>f(t,u));return u}function promptClearTasks(){confirm("Are you sure?")&&(clearTimeout(timerTimeout),tasksList.innerHTML="",updateTasks([]))}function promptRemoveTask(e){tasksList.removeChild($(`li[data-id="${e}"]`)),updateTasks(tasks.filter(t=>t.id!==e))}function renderTasks(){tasksList.innerHTML="";for(const t of tasks){const e=taskItem(t);tasksList.appendChild(e),Number.isInteger(t.started)&&(Number.isInteger(t.completed)?e.querySelector(".timer").textContent=elapsedMinutes(t).toString():startCounting(t))}}function saveState(){window.localStorage.setItem("tasks",JSON.stringify(tasks))}function startBreak(t){breaking=!0;const a=t*minute;let r,s;progressBar.setAttribute("max",a),progressBar.setAttribute("value",0);const n=t=>{if(r=r||t,s=t-r,progressBar.setAttribute("value",s),s<a)return window.requestAnimationFrame(n);chime.play(),progressBar.removeAttribute("value"),progressBar.removeAttribute("max");for(const e of $$('button[data-action="start"]'))e.removeAttribute("disabled")};window.requestAnimationFrame(n)}function startCounting(e){const t=$(`li[data-id="${e.id}"]`),a=t.querySelector(".timer"),r=()=>{var t=Math.ceil((Date.now()-e.started)/minute);a.textContent=Math.max(1,t).toString()};r();var s=Date.now()%minute,n=e.started%minute,n=n<s?minute+n-s:n-s;timerTimeout=setTimeout(()=>{r(),timerTimeout=null,timerInterval=setInterval(r,minute)},n)}function startMoving(t){t.setAttribute("draggable","true")}function startTask(t){var e={...getTask(t.getAttribute("data-id")),started:Date.now()};updateTask(e),startCounting(e),t.classList.add("-active");for(const a of $$('button[data-action="start"]'))a.setAttribute("disabled","")}function taskItem(t){return h("li",{attributes:{"data-id":t.id},children:[button("move","≡"),button("start",{attributes:{disabled:busyWithTask()?"":void 0},textContent:"ᐅ"}),button("complete",{attributes:{disabled:Number.isInteger(t.completed)?"":void 0},children:[h("span.timer"),h("em","✓")]}),h("input",{attributes:{type:"text",value:t.name}}),button("delete","×")],classes:[Number.isInteger(t.started)?Number.isInteger(t.completed)?"-done":"-active":void 0]})}function updateTask(e){updateTasks(tasks.map(t=>t.id===e.id?e:t))}function updateTasks(t){tasks=t,saveState()}window.addEventListener("click",t=>{var e=t.target.getAttribute("data-action");if(e)switch(e){case"clear":return promptClearTasks();case"complete":return completeTask(t.target.parentElement.getAttribute("data-id"));case"create":return addTask();case"delete":return promptRemoveTask(t.target.parentElement.getAttribute("data-id"));case"move":return;case"start":return startTask(t.target.parentElement);default:console.log(`Didn‘t handle “${e}” action`)}}),window.addEventListener("dragend",()=>{updateTasks(Array.from(tasksList.children).map(e=>tasks.find(t=>t.id===e.getAttribute("data-id")))),draggingItem.removeAttribute("draggable"),draggingItem=void 0}),window.addEventListener("dragover",t=>{var e,a;if((t.preventDefault(),t.target.hasAttribute("data-id"))&&t.target!==draggingItem)return e=findTaskIndex(draggingItem),(a=findTaskIndex(t.target))<e?tasksList.insertBefore(draggingItem,t.target):a===tasksList.children.length-1?todoList.appendChild(draggingItem):void tasksList.insertBefore(draggingItem,tasksList.children.item(a+1))}),window.addEventListener("dragstart",t=>{draggingItem=t.target}),window.addEventListener("input",t=>{updateTask({...getTask(t.target.parentElement.getAttribute("data-id")),name:t.target.value})}),window.addEventListener("keyup",t=>{if(t.target===document.body){if(t.stopPropagation(),"a"===t.key)return addTask()}else if("Enter"===t.key)return t.target.blur()}),window.addEventListener("mousedown",t=>{"move"===t.target.getAttribute("data-action")&&startMoving(t.target.parentElement)}),renderTasks()</script>