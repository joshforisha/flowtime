<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"content="object-src 'none'; script-src 'unsafe-inline' 'self'"><meta name="description"content="A very simple interface for managing Flowtime tasks"><meta name="msapplication-TileColor"content="#DA532C"><meta name="theme-color"content="#5E81AC"><meta name="viewport"content="initial-scale=1,width=device-width"><title>Flowtime</title><link rel="apple-touch-icon"href="./apple-touch-icon.png"><link rel="icon"href="./icon-16.png"sizes="16x16"><link rel="icon"href="./icon-32.png"sizes="32x32"><link rel="manifest"href="./manifest.json"><link rel="mask-icon"href="./safari-pinned-tab.svg"color="#4C566A"><style>:root{font-size:18px;line-height:1.5;--nord0:#2e3440;--nord1:#3b4252;--nord2:#434c5e;--nord3:#4c566a;--nord4:#d8dee9;--nord5:#e5e9f0;--nord6:#eceff4;--nord7:#8fbcbb;--nord8:#88c0d0;--nord9:#81a1c1;--nordA:#5e81ac;--nordB:#bf616a;--nordC:#d08770;--nordD:#ebcb8b;--nordE:#a3be8c;--nordF:#b48ead;--sans-serif-fonts:-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,helvetica,Ubuntu,roboto,noto,arial,sans-serif}*{box-sizing:border-box}body{background-color:var(--nord0);color:var(--nord4);font-family:var(--sans-serif-fonts);font-weight:400;margin:0 auto;padding:20px}button{align-items:center;background-color:var(--nord4);border-radius:50%;border-width:0;color:var(--nord2);cursor:pointer;display:inline-flex;flex-shrink:0;font-family:inherit;font-size:1.25em;font-weight:500;justify-content:center;line-height:1;min-height:52px;min-width:52px;transition:all .1s ease-out;transition-property:background-color,color,opacity}button:disabled{cursor:not-allowed;opacity:.25}button[data-action=clear]{background-color:var(--nordC)}button[data-action=complete]{background-color:var(--nordE)}button[data-action=create]{background-color:var(--nord9)}button[data-action=delete]{background-color:var(--nordB);color:var(--nord4)}button[data-action=move]{cursor:grab;margin:0 10px}button[data-action=move]{background-color:var(--nord6)}button[data-action=start]{background-color:var(--nordD)}button[data-action=start]:disabled{opacity:0;pointer-events:none}input[type=text]{background-color:transparent;border:none;border-radius:2px;color:inherit;font:inherit;margin-left:10px;outline:1px solid var(--nord9);padding:0 5px;transition:outline .1s ease-out;width:100%}input[type=text]:focus{outline-color:var(--nord8)}li{border-radius:5px;display:flex;margin:1rem 0}li.-completed input[type=text]{color:var(--nord3)}li button[data-action=complete]{display:none}li.-active button[data-action=complete]{display:flex}li.-active button[data-action=start],li.-completed button[data-action=start]{display:none}li.-active input[type=text]{color:var(--nordD)}li.-active .timer{color:var(--nordD);opacity:.75}li.-completed button[data-action=complete]{display:flex;opacity:0;pointer-events:none}li.-completed .timer{color:inherit;opacity:.25}ul{list-style-type:none;margin:0 auto;max-width:30rem;padding-left:0}.timer{align-items:center;display:inline-flex;justify-content:flex-start;opacity:0;padding:0 10px;transition:opacity .1s ease-out;width:4rem}.timer::after{content:"m"}#Controls{display:flex;justify-content:center;margin:4rem 0 2rem}#Controls button{margin:0 10px}#Break{align-items:center;display:flex;flex-direction:column;justify-content:center;left:0;opacity:0;pointer-events:none;position:relative;top:0;transition:opacity 250ms ease-out;width:100%}#Break.-active{opacity:1;pointer-events:auto}#BreakProgress{background-color:var(--nord4);height:100%;width:0}#BreakProgressBar{border:2px solid var(--nord4);border-radius:5px;height:10px;margin-top:10px;max-width:20rem;overflow:hidden;width:90vw}#BreakTime{height:3rem;margin:0}@media screen and (min-width:768px){:root{font-size:20px}}@media screen and (min-width:1024px){:root{font-size:22px}}@media screen and (min-width:1440px){:root{font-size:24px}}@media screen and (hover:hover){button{opacity:.9;transition:opacity .1s ease-out}button[data-action=delete],button[data-action=move]{opacity:0}button:not(:disabled):hover{opacity:1!important}input[type=text]{outline-color:transparent}input[type=text]:not(:disabled):not(:focus):hover{outline-color:var(--nord9)}li:hover button[data-action=delete],li:hover button[data-action=move]{opacity:.9}}</style><div id="Break"><h1 id="BreakTime"></h1><div id="BreakProgressBar"><div id="BreakProgress"></div></div></div><ul id="TaskList"></ul><div id="Controls"><button data-action="create"title="Add task (shortcut: A)">&plus;</button> <button data-action="clear"title="Clear tasks">&times;</button></div><audio id="Chime"><source src="chime.wav"type="audio/wav"></audio><script>const emptyState={activeTaskId:void 0,startedTime:void 0,tasks:[]},$=("3"!==window.localStorage.getItem("version")&&(window.localStorage.clear(),window.localStorage.setItem("version","3"),window.localStorage.setItem("state",JSON.stringify(emptyState))),t=>document.querySelector(t)),$$=t=>Array.from(document.querySelectorAll(t)),breakContainer=$("#Break"),breakProgress=$("#BreakProgress"),breakTime=$("#BreakTime"),chimeAudio=$("#Chime"),taskList=$("#TaskList");let breaking=!1,draggingItem,state=JSON.parse(window.localStorage.getItem("state"))||emptyState,timerInterval=null,timerTimeout=null;function addTask(){var t={id:Date.now().toString(),name:""};const e=makeTaskItem(t);taskList.appendChild(e),e.querySelector("input").focus(),updateState({tasks:state.tasks.concat(t)})}function breakMinutes(t){return t<=4?1:t<=25?5:t<=50?8:t<=90?10:15}function disable(t){t.hasAttribute("disabled")||t.setAttribute("disabled","")}function enable(t){t.hasAttribute("disabled")&&t.removeAttribute("disabled")}function enableTasks(){for(const t of $$('li:not(.-active) button[data-action="start"]'))enable(t)}function findTaskIndex(t){for(var e in taskList.children)if(taskList.children.item(e)===t)return e}function h(t,e={}){const{actions:a,attributes:i,children:n,classes:s,textContent:r}=e=Array.isArray(e)?{children:e}:e;var[e,...t]=t.split(".");const o=document.createElement(e);if(i)for(var[d,c]of Object.entries(i))void 0!==c&&o.setAttribute(d,c);if(0<t.length&&o.classList.add(...t),s&&o.classList.add(...s.filter(t=>t)),r&&(o.textContent=r),n)for(const l of n)l&&o.appendChild(l);if(a)for(const[u,m]of Object.entries(a))o.addEventListener(u,t=>m(t,o));return o}function makeTaskItem(a){return h("li",{actions:{dragover:(t,e)=>{var a;if(t.preventDefault(),e!==draggingItem)return t=findTaskIndex(draggingItem),a=findTaskIndex(e),a<t?taskList.insertBefore(draggingItem,e):a===taskList.children.length-1?todoList.appendChild(draggingItem):void taskList.insertBefore(draggingItem,taskList.children.item(a+1))},dragstart:(t,e)=>{draggingItem=e}},attributes:{"data-id":a.id},children:[h("button",{actions:{click:t=>{if(void 0===state.activeTaskId){for(const e of $$('button[data-action="start"]'))disable(e);t.target.parentNode.classList.add("-active"),updateState({activeTaskId:a.id,startedTime:Date.now()}),startCounting()}}},attributes:{"data-action":"start",disabled:state.activeTaskId&&state.activeTaskId!==a.id||breaking?"":void 0,title:"Start"},textContent:"ᐅ"}),h("button",{actions:{click:t=>{stopCounting(),t.target.parentNode.classList.add("-completed"),t.target.parentNode.classList.remove("-active");const e=Math.max(1,Math.ceil((Date.now()-state.startedTime)/6e4));updateState({activeTaskId:void 0,startedTime:void 0,tasks:state.tasks.map(t=>t.id===a.id?{...t,duration:e}:t)}),startBreak(e)}},attributes:{"data-action":"complete",title:"Complete"},textContent:"✓"}),h("span.timer",{textContent:a.duration}),h("input",{actions:{input:t=>{updateTask({...a,name:t.target.value})},keydown:t=>{if("Enter"===t.key)return t.preventDefault(),t.target.blur()}},attributes:{disabled:void 0!==a.duration?"":void 0,type:"text",value:a.name}}),h("button",{actions:{mousedown:t=>{t.target.parentNode.setAttribute("draggable","true")}},attributes:{"data-action":"move",title:"Move"},textContent:"≡"}),h("button",{actions:{click:t=>{if(confirm("Are you sure?")){stopCounting();const e={tasks:state.tasks.filter(t=>t.id!==a.id)};state.activeTaskId===a.id&&(e.activeTaskId=void 0,e.startedTime=void 0,enableTasks()),taskList.removeChild(t.target.parentNode),updateState(e)}}},attributes:{"data-action":"delete",title:"Delete"},textContent:"×"})],classes:[state.activeTaskId===a.id?"-active":null,void 0!==a.duration?"-completed":null]})}function startCounting(){const t=$("li.-active"),e=t.querySelector(".timer"),a=()=>{var t=Math.ceil((Date.now()-state.startedTime)/6e4);e.textContent=Math.max(1,t).toString()};a();var i=Date.now()%6e4,n=state.startedTime%6e4,n=n<i?6e4+n-i:n-i;timerTimeout=setTimeout(()=>{a(),timerTimeout=null,timerInterval=setInterval(a,6e4)},n)}function startBreak(t){breaking=!0;const a=6e4*breakMinutes(t),i=Date.now();let n=Math.ceil(a/1e3);breakTime.textContent=n,breakProgress.style.width="0%",breakContainer.classList.add("-active");const s=setInterval(()=>{var t=Date.now()-i;if(n=Math.ceil((a-t)/1e3),breakTime.textContent=n,breakProgress.style.width=100*t/a+"%",breaking&&t>=a-250){breakContainer.classList.remove("-active"),breaking=!1;for(const e of $$('button[data-action="start"]'))enable(e)}t>=a&&(chimeAudio.play(),clearInterval(s))},250)}function stopCounting(){timerTimeout&&(clearTimeout(timerTimeout),timerTimeout=void 0),timerInterval&&(clearInterval(timerInterval),timerInterval=void 0)}function updateState(t){t&&(state={...state,...t}),window.localStorage.setItem("state",JSON.stringify(state))}function updateTask(e){updateState({tasks:state.tasks.map(t=>t.id===e.id?e:t)})}window.addEventListener("dragend",()=>{updateState({tasks:Array.from(taskList.children).map(e=>state.tasks.find(t=>t.id===e.getAttribute("data-id")))}),draggingItem.removeAttribute("draggable"),draggingItem=void 0}),window.addEventListener("keydown",t=>{t.target===document.body&&"a"===t.key&&(t.preventDefault(),addTask())}),$('button[data-action="clear"]').addEventListener("click",()=>{confirm("Clear all tasks?")&&(taskList.innerHTML="",updateState(emptyState))}),$('button[data-action="create"]').addEventListener("click",()=>{addTask()});for(const na of state.tasks)taskList.appendChild(makeTaskItem(na));state.activeTaskId&&startCounting()</script>