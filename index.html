<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"content="object-src 'none'; script-src 'unsafe-inline' 'self'"><meta name="description"content="A very simple interface for managing Flowtime tasks"><meta name="msapplication-TileColor"content="#DA532C"><meta name="theme-color"content="#4C566A"><meta name="viewport"content="initial-scale=1,width=device-width"><title>Flowtime</title><link rel="apple-touch-icon"href="./apple-touch-icon.png"><link rel="icon"href="./icon-16.png"sizes="16x16"><link rel="icon"href="./icon-32.png"sizes="32x32"><link rel="manifest"href="./manifest.json"><link rel="mask-icon"href="./safari-pinned-tab.svg"color="#4C566A"><style>:root{font-size:20px;line-height:1.5;--nord0:#2e3440;--nord1:#3b4252;--nord2:#434c5e;--nord3:#4c566a;--nord4:#d8dee9;--nord5:#e5e9f0;--nord6:#eceff4;--nord7:#8fbcbb;--nord8:#88c0d0;--nord9:#81a1c1;--nordA:#5e81ac;--nordB:#bf616a;--nordC:#d08770;--nordD:#ebcb8b;--nordE:#a3be8c;--nordF:#b48ead;--sans-serif-fonts:-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,helvetica,Ubuntu,roboto,noto,arial,sans-serif}*{box-sizing:border-box}body{background-color:var(--nord0);color:var(--nord4);font-family:var(--sans-serif-fonts);font-weight:300;margin:0 auto;padding:20px}button{background-color:var(--nord4);border-radius:2px;border-width:0;color:var(--nord0);cursor:pointer;flex-shrink:0;font-family:inherit;font-size:1em;padding:0 20px;min-height:44px;min-width:44px}button:disabled{cursor:not-allowed;opacity:.25}button.-caution{background-color:var(--nordD)}button.-danger{background-color:var(--nordB);color:var(--nord6)}button.-good{background-color:var(--nordE)}button.-icon{align-items:center;display:flex;font-size:1.5rem;justify-content:center;line-height:1;padding:0}button.-small{font-size:.67em}h1{margin:0}h2{align-items:center;display:flex;font-weight:400;margin:0 0 20px}h2>span:first-child{flex-grow:1}h2>:not(:last-child){margin-right:10px}input{background-color:transparent;border-color:transparent;border-radius:5px;border-style:solid;color:inherit;font:inherit;padding:0 5px;width:100%}input:focus-visible{outline-color:var(--nord8);outline-style:solid}section{background-color:var(--nord1);border-radius:5px;display:block;margin-top:40px;padding:10px}ul{background-color:var(--nord1);margin:0;padding-left:30px}.timer{font-size:.8em;margin-left:10px;opacity:.5}.timer::after{content:")";opacity:.5}.timer::before{content:"(";opacity:.5}#Break{align-items:center;background-color:var(--nord0);display:flex;flex-direction:column;height:8rem;justify-content:center;left:0;opacity:0;pointer-events:none;position:fixed;top:0;transition:opacity 250ms ease-out;width:100%}#Break.-active{opacity:1;pointer-events:auto}#BreakProgress{background-color:var(--nord4);height:100%;width:0}#BreakProgressBar{border:2px solid var(--nord4);border-radius:5px;height:10px;margin-top:10px;max-width:20rem;overflow:hidden;width:90vw}#Controls{align-items:center;display:flex;margin-top:20px}#Controls button{margin-right:20px}#CurrentTask{align-items:baseline;display:flex;font-size:2rem;min-height:3rem;opacity:0;pointer-events:none;transition:opacity .2s ease-out}#CurrentTask.-busy{opacity:1;pointer-events:auto}#Interrupted{width:9rem}#Interrupted .count{font-size:.85em;margin-left:10px;opacity:.5}#TodoTasks li{border-top:1px solid var(--nord2);display:flex;margin-top:5px;padding-top:5px}#TodoTasks li input{margin:0 5px}#TodoTasks ul{list-style-type:none;padding-left:0}@media screen and (min-width:1024px){:root{font-size:24px}section{margin-top:80px}}@media screen and (hover:hover){button{opacity:.9;transition:opacity .1s ease-out}button:not(:disabled):hover{opacity:1}}</style><div id="CurrentTask"><span class="name"></span> <span class="timer"></span></div><div id="Controls"><button class="-good"disabled="disabled"id="FinishTask">Finish</button> <button class="-caution"disabled="disabled"id="Interrupted">Interrupted <span class="count">—</span></button></div><section id="TodoTasks"><h2><span>Todo</span> <button class="-small -good"id="AddTodo">Add Todo</button> <button class="-small -danger"disabled="disabled"id="ClearTodos">Clear</button></h2><ul></ul></section><section id="CompletedTasks"><h2><span>Completed</span> <button class="-small -danger"disabled="disabled"id="ClearCompleted">Clear</button></h2><ul></ul></section><div id="Break"><h1 id="BreakTime"></h1><div id="BreakProgressBar"><div id="BreakProgress"></div></div></div><audio id="Chime"><source src="chime.wav"type="audio/wav"></audio><script>const emptyState={completedTasks:[],currentTask:null,todoTasks:[]},$=t=>document.querySelector(t),breakContainer=$("#Break"),breakProgress=$("#BreakProgress"),breakTime=$("#BreakTime"),chimeAudio=$("#Chime"),clearCompletedButton=$("#ClearCompleted"),clearTodosButton=$("#ClearTodos"),completedList=$("#CompletedTasks ul"),currentTask=$("#CurrentTask"),currentTaskName=$("#CurrentTask .name"),currentTimer=$("#CurrentTask .timer"),finishTaskButton=$("#FinishTask"),interruptedButton=$("#Interrupted"),interruptedCount=$("#Interrupted .count"),todoList=$("#TodoTasks ul");let breaking=!1,currentTimerInterval=null,currentTimerTimeout=null,state=JSON.parse(window.localStorage.getItem("state"))||emptyState;function addTodo(){var t={id:Date.now().toString(),name:""};appendTodo(t,!0),updateState({todoTasks:state.todoTasks.concat(t)})}function appendCompleted(t){const e=document.createElement("li"),a=(e.textContent=t.name,document.createElement("span"));a.classList.add("timer");var n=Math.ceil((t.finished-t.started)/6e4),t=0<t.interruptions?`, ${t.interruptions} interruption`+(1===t.interruptions?"":"s"):"";a.textContent=n+" min"+t,e.appendChild(a),completedList.appendChild(e)}function appendTodo(e,t=!1){const a=document.createElement("li"),n=(a.setAttribute("data-id",e.id),document.createElement("button")),r=(n.classList.add("-start"),n.addEventListener("click",()=>{todoList.removeChild(a),updateState({todoTasks:state.todoTasks.filter(t=>t.id!==e.id)}),startTask(e)}),n.textContent="Start",0===e.name.length&&n.setAttribute("disabled",""),a.appendChild(n),document.createElement("input")),s=(r.setAttribute("type","text"),r.value=e.name,r.addEventListener("input",()=>{e.name=r.value,(0<r.value.length&&null===state.currentTask&&!breaking?enable:disable)(n),updateState({todoTasks:state.todoTasks.map(t=>t.id===e.id?e:t)})}),a.appendChild(r),document.createElement("button"));s.classList.add("-danger","-icon"),s.textContent="×",s.addEventListener("click",()=>{window.confirm("Are you sure?")&&(todoList.removeChild(a),updateState({todoTasks:state.todoTasks.filter(t=>t.id!==e.id)}))}),a.appendChild(s),todoList.appendChild(a),t&&setTimeout(()=>r.focus(),50)}function breakMinutes(t){return t<=4?1:t<=25?5:t<=50?8:t<=90?10:15}function disable(t){t.hasAttribute("disabled")||t.setAttribute("disabled","")}function enable(t){t.hasAttribute("disabled")&&t.removeAttribute("disabled")}function populateCurrentTask(e){currentTaskName.textContent=e.name;const t=()=>{var t=Math.ceil((Date.now()-e.started)/6e4);currentTimer.textContent=Math.max(1,t)+" min"};t();var a=Date.now()%6e4,n=e.started%6e4,n=n<a?6e4+n-a:n-a;currentTimerTimeout=setTimeout(()=>{t(),currentTimerTimeout=null,currentTimerInterval=setInterval(t,6e4)},n),interruptedCount.textContent="0",currentTask.classList.add("-busy")}function startBreak(t){breaking=!0;const e=6e4*breakMinutes(t),a=Date.now();let n=Math.ceil(e/1e3);breakTime.textContent=n,breakProgress.style.width="0%",breakContainer.classList.add("-active");const r=setInterval(()=>{var t=Date.now()-a;n=Math.ceil((e-t)/1e3),breakTime.textContent=n,breakProgress.style.width=100*t/e+"%",breaking&&t>=e-250&&(breakContainer.classList.remove("-active"),breaking=!1,Array.from(document.querySelectorAll("button.-start")).filter(t=>0<t.nextSibling.value.length).forEach(t=>enable(t))),t>=e&&(chimeAudio.play(),clearInterval(r))},250)}function startTask(e){var t={...e,interruptions:0,started:Date.now()};populateCurrentTask(t),updateState({currentTask:t,todoTasks:state.todoTasks.filter(t=>t.id!==e.id)})}function updateState(t={}){state={...state,...t},window.localStorage.setItem("state",JSON.stringify(state)),null===state.currentTask?(disable(finishTaskButton),disable(interruptedButton)):(interruptedCount.textContent=state.currentTask.interruptions.toString(),enable(finishTaskButton),enable(interruptedButton),Array.from(document.querySelectorAll("button.-start")).forEach(t=>disable(t))),(0<state.todoTasks.length?enable:disable)(clearTodosButton),(0<state.completedTasks.length?enable:disable)(clearCompletedButton)}state.currentTask&&populateCurrentTask(state.currentTask),state.todoTasks.forEach(t=>appendTodo(t)),state.completedTasks.forEach(t=>appendCompleted(t)),finishTaskButton.addEventListener("click",()=>{var t={...state.currentTask,finished:Date.now()};appendCompleted(t),currentTask.classList.remove("-busy"),interruptedCount.textContent="—",breakContainer.classList.add("-active"),currentTimerTimeout&&(clearTimeout(currentTimerTimeout),currentTimerTimeout=null),currentTimerInterval&&(clearInterval(currentTimerInterval),currentTimerInterval=null),startBreak(Math.ceil((t.finished-t.started)/6e4)),updateState({completedTasks:state.completedTasks.concat(t),currentTask:null})}),interruptedButton.addEventListener("click",()=>{updateState({currentTask:{...state.currentTask,interruptions:state.currentTask.interruptions+1}})}),$("#AddTodo").addEventListener("click",addTodo),clearCompletedButton.addEventListener("click",()=>{window.confirm("Are you sure?")&&(completedList.innerHTML="",updateState({completedTasks:[]}))}),clearTodosButton.addEventListener("click",()=>{window.confirm("Are you sure?")&&(todoList.innerHTML="",updateState({todoTasks:[]}))}),updateState(),window.addEventListener("keydown",t=>{t.target===document.body&&"a"===t.key&&addTodo()}),"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js")</script>