<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"content="object-src 'none'; script-src 'unsafe-inline' 'self'"><meta name="description"content="A very simple interface for managing Flowtime tasks"><meta name="msapplication-TileColor"content="#DA532C"><meta name="theme-color"content="#5E81AC"><meta name="viewport"content="initial-scale=1,width=device-width"><title>Flowtime</title><link rel="apple-touch-icon"href="./apple-touch-icon.png"><link rel="icon"href="./icon-16.png"sizes="16x16"><link rel="icon"href="./icon-32.png"sizes="32x32"><link rel="manifest"href="./manifest.json"><link rel="mask-icon"href="./safari-pinned-tab.svg"color="#4C566A"><style>:root{font-size:18px;line-height:1.5;--nord0:#2e3440;--nord1:#3b4252;--nord2:#434c5e;--nord3:#4c566a;--nord4:#d8dee9;--nord5:#e5e9f0;--nord6:#eceff4;--nord7:#8fbcbb;--nord8:#88c0d0;--nord9:#81a1c1;--nordA:#5e81ac;--nordB:#bf616a;--nordC:#d08770;--nordD:#ebcb8b;--nordE:#a3be8c;--nordF:#b48ead;--sans-serif-fonts:-apple-system,BlinkMacSystemFont,avenir next,avenir,segoe ui,helvetica neue,helvetica,Ubuntu,roboto,noto,arial,sans-serif}*{box-sizing:border-box}body{background-color:var(--nord0);color:var(--nord4);font-family:var(--sans-serif-fonts);font-weight:300;margin:0 auto;padding:20px}button{align-items:center;background-color:var(--nord4);border-radius:2px;border-width:0;color:var(--nord0);cursor:pointer;display:inline-flex;flex-shrink:0;font-family:inherit;font-size:1em;justify-content:center;min-height:44px;min-width:44px;padding:0 20px}button:disabled{cursor:not-allowed;opacity:.25}button.-caution{background-color:var(--nordD)}button.-danger{background-color:var(--nordB);color:var(--nord6)}button.-good{background-color:var(--nordE)}button.-icon{font-size:1.5rem;line-height:1;padding:0}button.-small{font-size:.67em}button.handle{background-color:var(--nord3);color:var(--nord4);cursor:grab}button[data-action=edit-flags]{background-color:var(--nord3);color:var(--nord4);margin-right:5px}button[data-action=start-task]{margin-left:5px}dialog{align-items:center;background-color:var(--nord6);border-radius:2px;border-style:none;flex-direction:column}dialog[open]{display:flex}dialog::backdrop{backdrop-filter:blur(5px)}dialog>form{align-items:center;display:flex;flex-direction:column;width:100%}fieldset{border-style:none;margin:0 0 30px;padding:0}h1{margin:0}h2{align-items:center;display:flex;font-weight:300;margin:0 0 20px}h2>span:first-child{flex-grow:1}h2>:not(:last-child){margin-right:10px}input[type=checkbox]{appearance:none;background-color:var(--nord0);border-radius:2px;height:1.25em;padding:0;width:1.25em}input[type=checkbox]:checked{background-color:var(--nordE)}input[type=text]{background-color:transparent;border-color:transparent;border-radius:5px;border-style:solid;color:inherit;font:inherit;padding:0 5px;width:100%}input[type=text]:focus-visible{outline-color:var(--nord8);outline-style:solid}label{align-items:center;cursor:pointer;display:flex}label input[type=checkbox]{margin-right:5px}label input[type=checkbox]:not(:checked)~span{color:var(--nord4);opacity:.6}label:hover input[type=checkbox]:not(:checked){background-color:var(--nord2)}label:hover input[type=checkbox]:not(:checked)~span{opacity:.8}section{background-color:var(--nord1);border-radius:5px;display:block;margin-top:2.5rem;padding:10px}ul{list-style-type:none;margin:0;padding-left:0}.task-item{display:flex;flex-direction:column}.task-item .content{border-top:1px solid var(--nord2);display:flex;margin-top:5px;padding-top:5px}.task-item .content input[type=text]{margin:0 5px}.task-item .flags{display:flex;flex-wrap:wrap;padding-left:calc(4rem + 64px)}.task-item .flags label{margin-right:1rem;white-space:nowrap}.task-flag{background-color:var(--nord5);display:flex;margin-bottom:10px}.tasks-list{background-color:var(--nord1)}.timer{font-size:.8em;margin-left:10px;opacity:.5}.timer::after{content:")";opacity:.5}.timer::before{content:"(";opacity:.5}#Break{align-items:center;background-color:var(--nord0);display:flex;flex-direction:column;height:8rem;justify-content:center;left:0;opacity:0;pointer-events:none;position:fixed;top:0;transition:opacity 250ms ease-out;width:100%}#Break.-active{opacity:1;pointer-events:auto}#BreakProgress{background-color:var(--nord4);height:100%;width:0}#BreakProgressBar{border:2px solid var(--nord4);border-radius:5px;height:10px;margin-top:10px;max-width:20rem;overflow:hidden;width:90vw}#Controls{align-items:center;display:flex;margin-top:20px}#Controls button{margin-right:20px}#CurrentTask{opacity:0;pointer-events:none;transition:opacity .2s ease-out}#CurrentTask.-busy{opacity:1;pointer-events:auto}#CurrentTask button{margin-right:10px}#CurrentTask .name{display:block;font-size:2rem;line-height:1;margin-bottom:20px;min-height:2rem}#Interrupted{width:9rem}#Interrupted .count{font-size:.85em;margin-left:10px;opacity:.5}@media screen and (min-width:768px){:root{font-size:20px}}@media screen and (min-width:1024px){:root{font-size:22px}}@media screen and (min-width:1440px){:root{font-size:24px}}@media screen and (hover:hover){button{opacity:.9;transition:opacity .1s ease-out}button:not(:disabled):hover{opacity:1}}</style><div id="CurrentTask"><span class="name"></span> <button class="-good"disabled="disabled"id="FinishTask">Finish <span class="timer"></span></button> <button class="-caution"disabled="disabled"id="Interrupted">Interrupted <span class="count">—</span></button></div><section id="TodoTasks"><h2><span>Todo</span> <button class="-small -good"id="AddTodo">Add Todo</button> <button class="-small -danger"disabled="disabled"id="ClearTodos">Clear</button></h2><ul class="tasks-list"></ul></section><section id="CompletedTasks"><h2><span>Completed</span> <button class="-small -danger"disabled="disabled"id="ClearCompleted">Clear</button></h2><ul></ul></section><div id="Break"><h1 id="BreakTime"></h1><div id="BreakProgressBar"><div id="BreakProgress"></div></div></div><audio id="Chime"><source src="chime.wav"type="audio/wav"></audio><dialog id="EditFlags"><h2>FUN-2306-select-wallet</h2><form method="dialog"><fieldset></fieldset><button type="submit">Close</button></form></dialog><script>const emptyState={completedTasks:[],currentTask:null,todoTasks:[]},$=t=>document.querySelector(t),$$=t=>Array.from(document.querySelectorAll(t)),breakContainer=$("#Break"),breakProgress=$("#BreakProgress"),breakTime=$("#BreakTime"),chimeAudio=$("#Chime"),clearCompletedButton=$("#ClearCompleted"),clearTodosButton=$("#ClearTodos"),completedList=$("#CompletedTasks ul"),currentTask=$("#CurrentTask"),currentTaskName=$("#CurrentTask .name"),currentTimer=$("#CurrentTask .timer"),editFlagsDialog=$("#EditFlags"),finishTaskButton=$("#FinishTask"),interruptedButton=$("#Interrupted"),interruptedCount=$("#Interrupted .count"),todoList=$("#TodoTasks ul");let breaking=!1,currentTimerInterval=null,currentTimerTimeout=null,draggingItem,state=JSON.parse(window.localStorage.getItem("state"))||emptyState;function addTodo(){var t={flags:[],id:generateId(),name:""};appendTodo(t,!0),updateState({todoTasks:state.todoTasks.concat(t)})}function appendCompleted(t){var e=Math.ceil((t.finished-t.started)/6e4),a=0<t.interruptions?`, ${t.interruptions} interruption`+(1===t.interruptions?"":"s"):"";completedList.appendChild(h("li",{textContent:t.name,children:[h("span",{classes:["timer"],textContent:e+" min"+a})]}))}function appendTodo(e,t=!1){const a=h("li",{classes:["task-item"],attributes:{"data-id":e.id},actions:{dragend:t=>{updateState({todoTasks:Array.from(todoList.children).map(e=>state.todoTasks.find(t=>t.id===e.getAttribute("data-id")))}),draggingItem.removeAttribute("draggable"),draggingItem=void 0},dragstart:(t,e)=>{draggingItem=e},dragover:(t,e)=>{var a;if(t.preventDefault(),e!==draggingItem)return t=findTodoIndex(draggingItem),a=findTodoIndex(e),a<t?todoList.insertBefore(draggingItem,e):a===todoList.children.length-1?todoList.appendChild(draggingItem):void todoList.insertBefore(draggingItem,todoList.children.item(a+1))}},children:[h("div",{classes:["content"],children:[h("button",{textContent:"≡",classes:["handle"],actions:{mousedown:t=>{t.target.parentNode.parentNode.setAttribute("draggable","true")}}}),h("button",{textContent:"Start",attributes:{"data-action":"start-task",disabled:0===e.name.length?"":void 0},actions:{click:t=>{todoList.removeChild(t.target.closest("li")),updateState({todoTasks:state.todoTasks.filter(t=>t.id!==e.id)}),startTask(e)}}}),h("input",{attributes:{"aria-label":"task name",type:"text",value:e.name},actions:{keydown:t=>{"Enter"===t.key&&t.target.blur()},input:t=>{e.name=t.target.value,toggle(t.target.closest("li").querySelector('button[data-action="start-task"]'),0<t.target.value.length&&null===state.currentTask&&!breaking),updateTodo(e)}}}),h("button",{textContent:"⋮",attributes:{"data-action":"edit-flags"},actions:{click:()=>{editFlags(e)}}}),h("button",{classes:["-danger","-icon"],textContent:"×",actions:{click:t=>{window.confirm("Are you sure?")&&(todoList.removeChild(t.target.closest("li")),updateState({todoTasks:state.todoTasks.filter(t=>t.id!==e.id)}))}}})]}),h("div",{classes:["flags"]})]});todoList.appendChild(a),renderTaskFlags(e),t&&setTimeout(()=>a.querySelector("input").focus(),5)}function breakMinutes(t){return t<=4?1:t<=25?5:t<=50?8:t<=90?10:15}function disable(t){t.hasAttribute("disabled")||t.setAttribute("disabled","")}function editFlags(a){$("#EditFlags h2").textContent=a.name;const t=$("#EditFlags fieldset"),n=(t.innerHTML="",h("ul",{classes:["flags-list"]}));for(const r of a.flags)n.appendChild(makeTaskFlag(a,r));t.appendChild(n);var e=h("button",{actions:{click:()=>{var t={checked:!1,id:generateId(),name:""};a.flags=a.flags.concat(t),updateTodo(a);const e=makeTaskFlag(a,t);n.appendChild(e),e.querySelector("input").focus(),renderTaskFlags(a)}},attributes:{type:"button"},classes:["-good"],textContent:"Add"});t.appendChild(e),editFlagsDialog.showModal()}function enable(t){t.hasAttribute("disabled")&&t.removeAttribute("disabled")}function findTodoIndex(t){for(var e in todoList.children)if(todoList.children.item(e)===t)return e}function generateId(){return Date.now().toString()}function h(t,{actions:e,attributes:a,children:n,classes:r,textContent:s}={}){const o=document.createElement(t);return a&&Object.entries(a).forEach(([t,e])=>{void 0!==e&&o.setAttribute(t,e)}),r&&o.classList.add(...r),s&&(o.textContent=s),n&&n.forEach(t=>{t&&o.appendChild(t)}),e&&Object.entries(e).forEach(([t,e])=>{o.addEventListener(t,t=>e(t,o))}),o}function makeTaskFlag(e,a){return h("li",{classes:["task-flag"],children:[h("input",{attributes:{"aria-label":"flag name",type:"text",value:a.name},actions:{input:t=>{a.name=t.target.value,e.flags=e.flags.map(t=>t.id===a.id?a:t),updateTodo(e),renderTaskFlags(e)}}}),h("button",{actions:{click:()=>{window.confirm("Are you sure?")&&($("#EditFlags ul").removeChild(event.target.closest("li")),e.flags=e.flags.filter(t=>t.id!==a.id),updateTodo(e),renderTaskFlags(e))}},attributes:{type:"button"},classes:["-danger","-icon"],textContent:"×"})]})}function populateCurrentTask(e){currentTaskName.textContent=e.name;const t=()=>{var t=Math.ceil((Date.now()-e.started)/6e4);currentTimer.textContent=Math.max(1,t)+" min"};t();var a=Date.now()%6e4,n=e.started%6e4,n=n<a?6e4+n-a:n-a;currentTimerTimeout=setTimeout(()=>{t(),currentTimerTimeout=null,currentTimerInterval=setInterval(t,6e4)},n),interruptedCount.textContent="0",currentTask.classList.add("-busy")}function renderCompletedList(){completedList.innerHTML="",state.completedTasks.forEach(t=>appendCompleted(t))}function updateTodo(e){updateState({todoTasks:state.todoTasks.map(t=>t.id===e.id?e:t)})}function renderTaskFlags(e){const t=$(`.task-item[data-id="${e.id}"] .flags`);t.innerHTML="";for(const a of e.flags)t.appendChild(h("label",{children:[h("input",{actions:{input:t=>{a.checked=t.target.checked,e.flags=e.flags.map(t=>t.id===a.id?a:t),updateTodo(e)}},attributes:{checked:a.checked?"":void 0,type:"checkbox"}}),h("span",{textContent:a.name})]}))}function renderTodoList(){todoList.innerHTML="",state.todoTasks.forEach(t=>appendTodo(t))}function startBreak(t){breaking=!0;const e=6e4*breakMinutes(t),a=Date.now();let n=Math.ceil(e/1e3);breakTime.textContent=n,breakProgress.style.width="0%",breakContainer.classList.add("-active");const r=setInterval(()=>{var t=Date.now()-a;n=Math.ceil((e-t)/1e3),breakTime.textContent=n,breakProgress.style.width=100*t/e+"%",breaking&&t>=e-250&&(breakContainer.classList.remove("-active"),breaking=!1,$$("button.start").filter(t=>0<t.nextSibling.value.length).forEach(t=>enable(t))),t>=e&&(chimeAudio.play(),clearInterval(r))},250)}function startTask(e){var t={...e,interruptions:0,started:Date.now()};populateCurrentTask(t),updateState({currentTask:t,todoTasks:state.todoTasks.filter(t=>t.id!==e.id)})}function toggle(t,e){if(e)return enable(t);disable(t)}function updateState(t){t&&(state={...state,...t}),window.localStorage.setItem("state",JSON.stringify(state)),null===state.currentTask?(disable(finishTaskButton),disable(interruptedButton)):(interruptedCount.textContent=state.currentTask.interruptions.toString(),enable(finishTaskButton),enable(interruptedButton),$$("button.start").forEach(t=>disable(t))),toggle(clearTodosButton,0<state.todoTasks.length),toggle(clearCompletedButton,0<state.completedTasks.length)}state.currentTask&&populateCurrentTask(state.currentTask),renderTodoList(),renderCompletedList(),finishTaskButton.addEventListener("click",()=>{var t={...state.currentTask,finished:Date.now()};appendCompleted(t),currentTask.classList.remove("-busy"),interruptedCount.textContent="—",breakContainer.classList.add("-active"),currentTimerTimeout&&(clearTimeout(currentTimerTimeout),currentTimerTimeout=null),currentTimerInterval&&(clearInterval(currentTimerInterval),currentTimerInterval=null),setTimeout(()=>{currentTaskName.textContent=""},200),startBreak(Math.ceil((t.finished-t.started)/6e4)),updateState({completedTasks:state.completedTasks.concat(t),currentTask:null})}),interruptedButton.addEventListener("click",()=>{updateState({currentTask:{...state.currentTask,interruptions:state.currentTask.interruptions+1}})}),document.getElementById("AddTodo").addEventListener("click",addTodo),clearCompletedButton.addEventListener("click",()=>{window.confirm("Are you sure?")&&(completedList.innerHTML="",updateState({completedTasks:[]}))}),clearTodosButton.addEventListener("click",()=>{window.confirm("Are you sure?")&&(todoList.innerHTML="",updateState({todoTasks:[]}))}),updateState(),window.addEventListener("keydown",t=>{t.target===document.body&&"a"===t.key&&addTodo()})</script>